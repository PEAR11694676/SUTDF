
import numpy as np


from add_target1 import add_target_pixel
import matplotlib.pyplot as plt
# 80*len(H) = 60*120 = 7200,用到水背景的前7200个像素
def train_data_generate(guide_data,label,r,l):
    for j in range(60):
        delta = j * len(H)
        for i in range(len(H)):
            guide_data[i + delta] = add_target_pixel(r, H[i], i+delta)
            label[i + delta] = l
    return guide_data,label


"""测试集生成：正方行
x1,x2:第几行到第几行
y1,y2：第几列到第几列
r_water:测试集从水背景的第7200个像素取
"""
def test_data_generate(HSI_curve,test_label,x1,x2,y1,y2,r,h,label):
    r_water = 7200
    for i in range(x1, x2):
        delta = i * 100
        for j in range(y1, y2):
            HSI_curve[j + delta] = add_target_pixel(r, h, r_water)
            test_label[j + delta] = label
            r_water += 1
    return HSI_curve,test_label




if __name__ == '__main__':
        # read HSI all curve from npy file
        HSI_curve = np.load('../data/all_curve.npy')  #(10000, 176)
        #标签分别为 Iron ： 0  Nylon_Carpet：1 Plastic_PETE ：2   Wood_Beam：3
        r_b_Iron = [0.014718, 0.015167, 0.015150, 0.015527, 0.015508, 0.015317, 0.015252, 0.015342, 0.015538, 0.015569,
                    0.015513, 0.015639, 0.015569, 0.015472, 0.015404, 0.015376, 0.015190, 0.015161, 0.015085, 0.015007,
                    0.014999, 0.014950, 0.014951, 0.014801, 0.014876, 0.014866, 0.014770, 0.014825, 0.014811, 0.014820,
                    0.014841, 0.014901, 0.014874, 0.014973, 0.014947, 0.015105, 0.015124, 0.015308, 0.015318, 0.015470,
                    0.015563, 0.015764, 0.015914, 0.016153, 0.016488, 0.016852, 0.017229, 0.017928, 0.018605, 0.019501,
                    0.021006, 0.022542, 0.024429, 0.027729, 0.030904, 0.034651, 0.040668, 0.045924, 0.051871, 0.060028,
                    0.065805, 0.072023, 0.081160, 0.087191, 0.092602, 0.099576, 0.104169, 0.108454, 0.113588, 0.117073,
                    0.120221, 0.124061, 0.126614, 0.132053, 0.134319, 0.137303, 0.140356, 0.142681, 0.145076, 0.148371,
                    0.150959, 0.154537, 0.157417, 0.161388, 0.164491, 0.167750, 0.172250, 0.175710, 0.180516, 0.184192,
                    0.189189, 0.193005, 0.196790, 0.201854, 0.205538, 0.210355, 0.214934, 0.218140, 0.222067, 0.224702,
                    0.226994, 0.229562, 0.231045, 0.232486, 0.233126, 0.233431, 0.233240, 0.232493, 0.231260, 0.230043,
                    0.228169, 0.226528, 0.224176, 0.222321, 0.219703, 0.217707, 0.215042, 0.213026, 0.210374, 0.208430,
                    0.205948, 0.204137, 0.201854, 0.200251, 0.198187, 0.196763, 0.194973, 0.193773, 0.192309, 0.191372,
                    0.190243, 0.189506, 0.188664, 0.188017, 0.187554, 0.187324, 0.187256, 0.187294, 0.187468, 0.187866,
                    0.188299, 0.189010, 0.189918, 0.190987, 0.191914, 0.193345, 0.194543, 0.196278, 0.197711, 0.199733,
                    0.201983, 0.204445, 0.206399, 0.209196, 0.212180, 0.214549, 0.217868, 0.221349, 0.224101, 0.227970,
                    0.232029, 0.235144, 0.239500, 0.243972, 0.247443, 0.252194, 0.257062, 0.260804, 0.265909, 0.270982,
                    0.274832, 0.280087, 0.285247, 0.290366, 0.294283, 0.299747]
        r_b_Nylon_Carpet = [0.058373, 0.057862, 0.057581, 0.057508, 0.057708, 0.057998, 0.058008, 0.057883, 0.057717,
                            0.057422,
                            0.057309, 0.056478, 0.056003, 0.056649, 0.058021, 0.059188, 0.059733, 0.060688, 0.061477,
                            0.062436,
                            0.063571, 0.06536, 0.066774, 0.068197, 0.069543, 0.070787, 0.072154, 0.073015, 0.073847,
                            0.075126,
                            0.076232, 0.077518, 0.078955, 0.080873, 0.082137, 0.08321, 0.0847, 0.085134, 0.085654,
                            0.086748,
                            0.087974, 0.089496, 0.091658, 0.093119, 0.093794, 0.093457, 0.094627, 0.094921, 0.094914,
                            0.095451,
                            0.096828, 0.100558, 0.105088, 0.111146, 0.120897, 0.129385, 0.138328, 0.149176, 0.156373,
                            0.1626,
                            0.169424, 0.173577, 0.178133, 0.180902, 0.183122, 0.185297, 0.18639, 0.187081, 0.187608,
                            0.187876,
                            0.188388, 0.189126, 0.190321, 0.192899, 0.195714, 0.200771, 0.205632, 0.21138, 0.22046,
                            0.228347,
                            0.240176, 0.250011, 0.264235, 0.27567, 0.287645, 0.304249, 0.316976, 0.334022, 0.34671,
                            0.363096,
                            0.374838, 0.389413, 0.399444, 0.408582, 0.419371, 0.428549, 0.43442, 0.440977, 0.445102,
                            0.448602,
                            0.452455, 0.454866, 0.457505, 0.459176, 0.461068, 0.462268, 0.463848, 0.464992, 0.466386,
                            0.467768,
                            0.468705, 0.46985, 0.470655, 0.47167, 0.472387, 0.47323, 0.473872, 0.474669, 0.475229,
                            0.475964,
                            0.476521, 0.477207, 0.477603, 0.478327, 0.478988, 0.479487, 0.480132, 0.480655, 0.481415,
                            0.482128,
                            0.482578, 0.483318, 0.483876, 0.484485, 0.485077, 0.485532, 0.486059, 0.486417, 0.486869,
                            0.487239,
                            0.487486, 0.487758, 0.48799, 0.488116, 0.488015, 0.487927, 0.487646, 0.487094, 0.486421,
                            0.485273,
                            0.484215, 0.483041, 0.482405, 0.482494, 0.483384, 0.48502, 0.487079, 0.48871, 0.490818,
                            0.492102,
                            0.493543, 0.49465, 0.495345, 0.496122, 0.496816, 0.497357, 0.497764, 0.498297, 0.498705,
                            0.498886,
                            0.499155, 0.49933, 0.499413, 0.499387, 0.499309, 0.49903]
        r_b_Plastic_PETE = [0.006541, 0.006098, 0.005848, 0.005625, 0.005364, 0.005214, 0.005079, 0.004991, 0.004911,
                            0.004781, 0.004709,
                            0.004652, 0.004642, 0.004636, 0.004588, 0.004567, 0.004552, 0.004522, 0.004568, 0.004575,
                            0.004585, 0.004707,
                            0.004811, 0.004944, 0.005085, 0.005226, 0.005378, 0.005461, 0.005526, 0.005584, 0.005632,
                            0.005629, 0.005606,
                            0.00557, 0.005542, 0.005538, 0.005659, 0.005789, 0.006006, 0.006455, 0.006892, 0.007408,
                            0.008149, 0.008698,
                            0.009186, 0.009754, 0.010145, 0.010573, 0.011335, 0.01218, 0.013377, 0.01573, 0.018244,
                            0.021493, 0.026971,
                            0.031728, 0.036655, 0.042763, 0.046469, 0.049171, 0.051273, 0.051969, 0.052157, 0.052035,
                            0.051887, 0.051758,
                            0.051726, 0.051701, 0.051603, 0.0514, 0.050889, 0.050325, 0.049643, 0.048656, 0.047985,
                            0.047399, 0.047336, 0.047711,
                            0.049085, 0.050875, 0.054487, 0.058249, 0.064871, 0.071193, 0.078807, 0.091111, 0.102016,
                            0.118842, 0.133079, 0.153933
            , 0.170742, 0.194137, 0.21206, 0.229975, 0.253213, 0.275142, 0.290393, 0.308842, 0.321168, 0.332184,
                            0.344928, 0.353048
            , 0.36219, 0.36792, 0.374128, 0.377934, 0.382201, 0.384722, 0.387399, 0.389477, 0.390722, 0.392053,
                            0.392845, 0.393738
            , 0.394259, 0.394865, 0.395254, 0.395667, 0.395959, 0.396264, 0.396502, 0.396781, 0.397021, 0.397309,
                            0.397587, 0.397789
            , 0.398116, 0.3983460, 0.398575, 0.398794, 0.398949, 0.399076, 0.399102, 0.39901, 0.398732, 0.398341,
                            0.39786, 0.398083, 0.398859
            , 0.399498, 0.399719, 0.399713, 0.39964, 0.399537, 0.399349, 0.399262, 0.399228, 0.399282, 0.399424,
                            0.399658, 0.399834
            , 0.400085, 0.400323, 0.400427, 0.400445, 0.400544, 0.400622, 0.400678, 0.400781, 0.400858, 0.400897,
                            0.400922, 0.400918
            , 0.40093, 0.400923, 0.400877, 0.400867, 0.400825, 0.400777, 0.400745, 0.400687, 0.400624, 0.40061,
                            0.400473, 0.400415, 0.400464]
        r_b_Wood_Beam = [0.123198, 0.131068, 0.139218, 0.147553, 0.158483, 0.166343, 0.173727, 0.180575, 0.186843,
                         0.194314, 0.199391,
                         0.203993, 0.208237, 0.213408, 0.217037, 0.220463, 0.223712, 0.227935, 0.230979, 0.233948,
                         0.236898, 0.240718,
                         0.243485, 0.246219, 0.248902, 0.251561, 0.255088, 0.257762, 0.260462, 0.264149, 0.266987,
                         0.269877, 0.272792,
                         0.276749, 0.279758, 0.282835, 0.290208, 0.293497, 0.296835, 0.30143, 0.304956, 0.308534,
                         0.3134, 0.317112, 0.320873,
                         0.325967, 0.329812, 0.333698, 0.338914, 0.34287, 0.346858, 0.352173, 0.35617, 0.360173,
                         0.365504, 0.369468, 0.373396,
                         0.378604, 0.382534, 0.386453, 0.391763, 0.39582, 0.401474, 0.405795, 0.410003, 0.41551,
                         0.419624, 0.423685, 0.429073,
                         0.433166, 0.438608, 0.442629, 0.446591, 0.451852, 0.455802, 0.461032, 0.464892, 0.468691,
                         0.473632, 0.477295, 0.482059,
                         0.485619, 0.490288, 0.493732, 0.497156, 0.501626, 0.504955, 0.509368, 0.512625, 0.516969,
                         0.520188, 0.524414, 0.527536,
                         0.530664, 0.534757, 0.538735, 0.541711, 0.545547, 0.548355, 0.551056, 0.554634, 0.557205,
                         0.560473, 0.562815, 0.565865,
                         0.568069, 0.570876, 0.572946, 0.575647, 0.578297, 0.580235, 0.582821, 0.584796, 0.587357,
                         0.589273, 0.591862, 0.593823,
                         0.596445, 0.598404, 0.601108, 0.603142, 0.605876, 0.607929, 0.61071, 0.613522, 0.61566,
                         0.618447, 0.620556, 0.62333,
                         0.626085, 0.628125, 0.630859, 0.632888, 0.635504, 0.637981, 0.639761, 0.642043, 0.643608,
                         0.645755, 0.647984, 0.649579,
                         0.651546, 0.653364, 0.654557, 0.655937, 0.656868, 0.657942, 0.658775, 0.659268, 0.659857,
                         0.660343, 0.661184, 0.662185,
                         0.663113, 0.664362, 0.665591, 0.666655, 0.667333, 0.668108, 0.668598, 0.669197, 0.669376,
                         0.669175, 0.668302, 0.666861,
                         0.664772, 0.662901, 0.660557, 0.658693, 0.657822, 0.657161, 0.657116, 0.657339, 0.657884,
                         0.658246, 0.657675]

        H = []
        h = 0.01
        while h <= 2:
            H.append(h)
            h += 0.02
            h = float('%.2f' % (h))
        while h <= 4:
            H.append(h)
            h += 0.2
            h = float('%.2f' % (h))
        while h<= 5:
            H.append(h)
            h += 0.1
            h = float('%.2f' % (h))
        # print(len(H)) 120


        color = ['r', 'maroon', 'firebrick', 'brown', 'lightcoral', 'sienna',
                 'y', 'm', 'peru', 'coral', 'teal', 'r', 'darkred', 'maroon', 'firebrick',
                 'brown', 'lightcoral', 'sienna', 'y', 'm', 'peru', 'coral', 'teal']
        # replace background pixels with underwater-target pixel
        # guide_data = np.zeros((60 * len(H), 176))
        # label = np.ones(60 * len(H))
        #
        # label_water = np.zeros(6000)
        # water = HSI_curve[:6000,:]
        #
        # np.save('../data/train_data/water.npy', water)
        # np.save('../data/train_data/water_label.npy', label_water)
        #
        # iron,iron_label = train_data_generate(guide_data,label,r_b_Iron,1)
        # np.save(r'..\Class\train_data\train\Iron.npy', iron)
        # np.save(r'..\Class\train_data\train\Iron_label.npy', iron_label)
        #
        # # Nylon_Carpet : 2
        # Nylon_Carpet, Nylon_Carpet_label = train_data_generate(guide_data, label, r_b_Nylon_Carpet, 2)
        # np.save(r'..\Class\train_data\train\Nylon_Carpet.npy', Nylon_Carpet)
        # np.save(r'..\Class\train_data\train\Nylon_Carpet_label.npy', Nylon_Carpet_label)
        #
        # # Plastic_PETE : 3
        # Plastic_PETE, Plastic_PETE_label = train_data_generate(guide_data, label, r_b_Plastic_PETE, 3)
        # np.save(r'..\Class\train_data\train\Plastic_PETE.npy', Plastic_PETE)
        # np.save(r'..\Class\train_data\train\Plastic_PETE_label.npy', Plastic_PETE_label)
        #
        # # Wood_Beam : 4
        # Wood_Beam, Wood_Beam_label = train_data_generate(guide_data, label, r_b_Wood_Beam, 4)
        # np.save(r'..\Class\train_data\train\Wood_Beam.npy', Wood_Beam)
        # np.save(r'..\Class\train_data\train\Wood_Beam_label.npy', Wood_Beam_label)

        # 0: 'water', 1: 'Iron', 2: 'Nylon_Carpet', 3: "Plastic_PETE", 4: "Wood_Beam"
        test_label = np.zeros(10000)

        test_curve1,test_label1 = test_data_generate(HSI_curve,test_label,20,40,20,40,r_b_Iron,4,1)
        test_curve2,test_label2 = test_data_generate(test_curve1,test_label1,20,40,60,80,r_b_Nylon_Carpet,4,2)
        test_curve3,test_label3 = test_data_generate(test_curve2, test_label2,60,80,20,40, r_b_Plastic_PETE,4,3)
        test_data,test_label = test_data_generate(test_curve3,test_label3,60,80,60,80, r_b_Wood_Beam,4,4)





        # for i in range(10000):
        #     print(test_label[i])
        #
        # a = test_data.reshape((100,100,176))
        # plt.imshow(a[:,:,100])
        # plt.show()
        # #
        # np.save('../data/test_data/Mix_target_4m.npy', test_data)
        # np.save('../data/test_data/Mix_target_4m_label.npy', test_label)





